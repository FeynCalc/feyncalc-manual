% !TeX program = pdflatex
% !TeX root = ExpandScalarProduct.tex

\documentclass[../FeynCalcManual.tex]{subfiles}
\begin{document}
\hypertarget{expandscalarproduct}{
\section{ExpandScalarProduct}\label{expandscalarproduct}\index{ExpandScalarProduct}}

\texttt{ExpandScalarProduct[\allowbreak{}expr]} expands scalar products
of sums of momenta in \texttt{expr}.

\texttt{ExpandScalarProduct} does not use \texttt{Expand} on
\texttt{expr}.

\subsection{See also}

\hyperlink{toc}{Overview}, \hyperlink{calc}{Calc},
\hyperlink{momentumexpand}{MomentumExpand},
\hyperlink{momentumcombine}{MomentumCombine},
\hyperlink{fcvariable}{FCVariable}

\subsection{Examples}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{SP}\OperatorTok{[}\NormalTok{p1 }\SpecialCharTok{+}\NormalTok{ p2 }\SpecialCharTok{+}\NormalTok{ p3}\OperatorTok{,}\NormalTok{ p4 }\SpecialCharTok{+}\NormalTok{ p5 }\SpecialCharTok{+}\NormalTok{ p6}\OperatorTok{]} 
 
\SpecialCharTok{\%} \SpecialCharTok{//}\NormalTok{ ExpandScalarProduct}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
(\overline{\text{p1}}+\overline{\text{p2}}+\overline{\text{p3}})\cdot (\overline{\text{p4}}+\overline{\text{p5}}+\overline{\text{p6}})
\end{dmath*}

\begin{dmath*}\breakingcomma
\overline{\text{p1}}\cdot \overline{\text{p4}}+\overline{\text{p1}}\cdot \overline{\text{p5}}+\overline{\text{p1}}\cdot \overline{\text{p6}}+\overline{\text{p2}}\cdot \overline{\text{p4}}+\overline{\text{p2}}\cdot \overline{\text{p5}}+\overline{\text{p2}}\cdot \overline{\text{p6}}+\overline{\text{p3}}\cdot \overline{\text{p4}}+\overline{\text{p3}}\cdot \overline{\text{p5}}+\overline{\text{p3}}\cdot \overline{\text{p6}}
\end{dmath*}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{SP}\OperatorTok{[}\FunctionTok{p}\OperatorTok{,} \FunctionTok{p} \SpecialCharTok{{-}} \FunctionTok{q}\OperatorTok{]} 
 
\NormalTok{ExpandScalarProduct}\OperatorTok{[}\SpecialCharTok{\%}\OperatorTok{]}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\overline{p}\cdot (\overline{p}-\overline{q})
\end{dmath*}

\begin{dmath*}\breakingcomma
\overline{p}^2-\overline{p}\cdot \overline{q}
\end{dmath*}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{FV}\OperatorTok{[}\FunctionTok{p} \SpecialCharTok{{-}} \FunctionTok{q}\OperatorTok{,} \SpecialCharTok{\textbackslash{}}\OperatorTok{[}\NormalTok{Mu}\OperatorTok{]]} 
 
\NormalTok{ExpandScalarProduct}\OperatorTok{[}\SpecialCharTok{\%}\OperatorTok{]}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\left(\overline{p}-\overline{q}\right)^{\mu }
\end{dmath*}

\begin{dmath*}\breakingcomma
\overline{p}^{\mu }-\overline{q}^{\mu }
\end{dmath*}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{SPD}\OperatorTok{[}\FunctionTok{p} \SpecialCharTok{{-}} \FunctionTok{q}\OperatorTok{,} \FunctionTok{q} \SpecialCharTok{{-}} \FunctionTok{r}\OperatorTok{]} 
 
\NormalTok{ExpandScalarProduct}\OperatorTok{[}\SpecialCharTok{\%}\OperatorTok{]}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
(p-q)\cdot (q-r)
\end{dmath*}

\begin{dmath*}\breakingcomma
p\cdot q-p\cdot r+q\cdot r-q^2
\end{dmath*}

Using the option \texttt{Momentum} one can limit the expansion to
particular momenta

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{SP}\OperatorTok{[}\NormalTok{p1 }\SpecialCharTok{+}\NormalTok{ p2 }\SpecialCharTok{+}\NormalTok{ p3}\OperatorTok{,}\NormalTok{ p4 }\SpecialCharTok{+}\NormalTok{ p5 }\SpecialCharTok{+}\NormalTok{ p6}\OperatorTok{]} 
 
\NormalTok{ExpandScalarProduct}\OperatorTok{[}\SpecialCharTok{\%}\OperatorTok{,}\NormalTok{ Momentum }\OtherTok{{-}\textgreater{}} \OperatorTok{\{}\NormalTok{p1}\OperatorTok{\}]}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
(\overline{\text{p1}}+\overline{\text{p2}}+\overline{\text{p3}})\cdot (\overline{\text{p4}}+\overline{\text{p5}}+\overline{\text{p6}})
\end{dmath*}

\begin{dmath*}\breakingcomma
\overline{\text{p1}}\cdot (\overline{\text{p4}}+\overline{\text{p5}}+\overline{\text{p6}})+(\overline{\text{p2}}+\overline{\text{p3}})\cdot (\overline{\text{p4}}+\overline{\text{p5}}+\overline{\text{p6}})
\end{dmath*}

By default \texttt{ExpandScalarProduct} does not apply linearity to
Levi-Civita tensors

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{LC}\OperatorTok{[}\SpecialCharTok{\textbackslash{}}\OperatorTok{[}\NormalTok{Mu}\OperatorTok{]][}\NormalTok{p1 }\SpecialCharTok{+}\NormalTok{ p2}\OperatorTok{,}\NormalTok{ p3 }\SpecialCharTok{+}\NormalTok{ p4}\OperatorTok{,}\NormalTok{ p5 }\SpecialCharTok{+}\NormalTok{ p6}\OperatorTok{]} 
 
\NormalTok{ExpandScalarProduct}\OperatorTok{[}\SpecialCharTok{\%}\OperatorTok{]}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\bar{\epsilon }^{\mu \overline{\text{p1}}+\overline{\text{p2}}\;\overline{\text{p3}}+\overline{\text{p4}}\;\overline{\text{p5}}+\overline{\text{p6}}}
\end{dmath*}

\begin{dmath*}\breakingcomma
\bar{\epsilon }^{\mu \overline{\text{p1}}+\overline{\text{p2}}\;\overline{\text{p3}}+\overline{\text{p4}}\;\overline{\text{p5}}+\overline{\text{p6}}}
\end{dmath*}

Using the option \texttt{EpsEvaluate} takes care of that

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{LC}\OperatorTok{[}\SpecialCharTok{\textbackslash{}}\OperatorTok{[}\NormalTok{Mu}\OperatorTok{]][}\NormalTok{p1 }\SpecialCharTok{+}\NormalTok{ p2}\OperatorTok{,}\NormalTok{ p3 }\SpecialCharTok{+}\NormalTok{ p4}\OperatorTok{,}\NormalTok{ p5 }\SpecialCharTok{+}\NormalTok{ p6}\OperatorTok{]} 
 
\NormalTok{ExpandScalarProduct}\OperatorTok{[}\SpecialCharTok{\%}\OperatorTok{,}\NormalTok{ EpsEvaluate }\OtherTok{{-}\textgreater{}} \ConstantTok{True}\OperatorTok{]}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\bar{\epsilon }^{\mu \overline{\text{p1}}+\overline{\text{p2}}\;\overline{\text{p3}}+\overline{\text{p4}}\;\overline{\text{p5}}+\overline{\text{p6}}}
\end{dmath*}

\begin{dmath*}\breakingcomma
\bar{\epsilon }^{\mu \overline{\text{p1}}\;\overline{\text{p3}}\;\overline{\text{p5}}}+\bar{\epsilon }^{\mu \overline{\text{p1}}\;\overline{\text{p3}}\;\overline{\text{p6}}}+\bar{\epsilon }^{\mu \overline{\text{p1}}\;\overline{\text{p4}}\;\overline{\text{p5}}}+\bar{\epsilon }^{\mu \overline{\text{p1}}\;\overline{\text{p4}}\;\overline{\text{p6}}}+\bar{\epsilon }^{\mu \overline{\text{p2}}\;\overline{\text{p3}}\;\overline{\text{p5}}}+\bar{\epsilon }^{\mu \overline{\text{p2}}\;\overline{\text{p3}}\;\overline{\text{p6}}}+\bar{\epsilon }^{\mu \overline{\text{p2}}\;\overline{\text{p4}}\;\overline{\text{p5}}}+\bar{\epsilon }^{\mu \overline{\text{p2}}\;\overline{\text{p4}}\;\overline{\text{p6}}}
\end{dmath*}

One can use the options \texttt{EpsEvaluate} and \texttt{Momentum}
together

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{LC}\OperatorTok{[}\SpecialCharTok{\textbackslash{}}\OperatorTok{[}\NormalTok{Mu}\OperatorTok{]][}\NormalTok{p1 }\SpecialCharTok{+}\NormalTok{ p2}\OperatorTok{,}\NormalTok{ p3 }\SpecialCharTok{+}\NormalTok{ p4}\OperatorTok{,}\NormalTok{ p5 }\SpecialCharTok{+}\NormalTok{ p6}\OperatorTok{]} 
 
\NormalTok{ExpandScalarProduct}\OperatorTok{[}\SpecialCharTok{\%}\OperatorTok{,}\NormalTok{ EpsEvaluate }\OtherTok{{-}\textgreater{}} \ConstantTok{True}\OperatorTok{,}\NormalTok{ Momentum }\OtherTok{{-}\textgreater{}} \OperatorTok{\{}\NormalTok{p1}\OperatorTok{\}]}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\bar{\epsilon }^{\mu \overline{\text{p1}}+\overline{\text{p2}}\;\overline{\text{p3}}+\overline{\text{p4}}\;\overline{\text{p5}}+\overline{\text{p6}}}
\end{dmath*}

\begin{dmath*}\breakingcomma
\bar{\epsilon }^{\mu \overline{\text{p1}}\;\overline{\text{p3}}+\overline{\text{p4}}\;\overline{\text{p5}}+\overline{\text{p6}}}+\bar{\epsilon }^{\mu \overline{\text{p2}}\;\overline{\text{p3}}+\overline{\text{p4}}\;\overline{\text{p5}}+\overline{\text{p6}}}
\end{dmath*}

Of course, the function is also applicable to Cartesian quantities

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CSP}\OperatorTok{[}\NormalTok{p1 }\SpecialCharTok{+}\NormalTok{ p2}\OperatorTok{,}\NormalTok{ p3 }\SpecialCharTok{+}\NormalTok{ p4}\OperatorTok{]} 
 
\NormalTok{ExpandScalarProduct}\OperatorTok{[}\SpecialCharTok{\%}\OperatorTok{]}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
(\overline{\text{p1}}+\overline{\text{p2}})\cdot (\overline{\text{p3}}+\overline{\text{p4}})
\end{dmath*}

\begin{dmath*}\breakingcomma
\overline{\text{p1}}\cdot \overline{\text{p3}}+\overline{\text{p1}}\cdot \overline{\text{p4}}+\overline{\text{p2}}\cdot \overline{\text{p3}}+\overline{\text{p2}}\cdot \overline{\text{p4}}
\end{dmath*}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CLC}\OperatorTok{[][}\NormalTok{p1 }\SpecialCharTok{+}\NormalTok{ p2}\OperatorTok{,}\NormalTok{ p3 }\SpecialCharTok{+}\NormalTok{ p4}\OperatorTok{,}\NormalTok{ p5 }\SpecialCharTok{+}\NormalTok{ p6}\OperatorTok{]} 
 
\NormalTok{ExpandScalarProduct}\OperatorTok{[}\SpecialCharTok{\%}\OperatorTok{,}\NormalTok{ EpsEvaluate }\OtherTok{{-}\textgreater{}} \ConstantTok{True}\OperatorTok{]}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\bar{\epsilon }^{\overline{\text{p1}}+\overline{\text{p2}}\;\overline{\text{p3}}+\overline{\text{p4}}\;\overline{\text{p5}}+\overline{\text{p6}}}
\end{dmath*}

\begin{dmath*}\breakingcomma
\bar{\epsilon }^{\overline{\text{p1}}\;\overline{\text{p3}}\;\overline{\text{p5}}}+\bar{\epsilon }^{\overline{\text{p1}}\;\overline{\text{p3}}\;\overline{\text{p6}}}+\bar{\epsilon }^{\overline{\text{p1}}\;\overline{\text{p4}}\;\overline{\text{p5}}}+\bar{\epsilon }^{\overline{\text{p1}}\;\overline{\text{p4}}\;\overline{\text{p6}}}+\bar{\epsilon }^{\overline{\text{p2}}\;\overline{\text{p3}}\;\overline{\text{p5}}}+\bar{\epsilon }^{\overline{\text{p2}}\;\overline{\text{p3}}\;\overline{\text{p6}}}+\bar{\epsilon }^{\overline{\text{p2}}\;\overline{\text{p4}}\;\overline{\text{p5}}}+\bar{\epsilon }^{\overline{\text{p2}}\;\overline{\text{p4}}\;\overline{\text{p6}}}
\end{dmath*}

Sometimes one would like to have external momenta multiplied by symbolic
parameters in the propagators. In this case one should first declare the
corresponding variables to be of \texttt{FCVariable} type

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{DataType}\OperatorTok{[}\FunctionTok{a}\OperatorTok{,}\NormalTok{ FCVariable}\OperatorTok{]} \ExtensionTok{=} \ConstantTok{True}\NormalTok{;}
\NormalTok{DataType}\OperatorTok{[}\FunctionTok{b}\OperatorTok{,}\NormalTok{ FCVariable}\OperatorTok{]} \ExtensionTok{=} \ConstantTok{True}\NormalTok{;}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ExpandScalarProduct}\OperatorTok{[}\NormalTok{SP}\OperatorTok{[}\FunctionTok{P}\OperatorTok{,} \FunctionTok{Q}\OperatorTok{]} \OtherTok{/.} \FunctionTok{P} \OtherTok{{-}\textgreater{}} \FunctionTok{a}\NormalTok{ P1 }\SpecialCharTok{+} \FunctionTok{b}\NormalTok{ P2}\OperatorTok{]} 
 
\FunctionTok{StandardForm}\OperatorTok{[}\SpecialCharTok{\%}\OperatorTok{]} 
  
 
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
a \left(\overline{\text{P1}}\cdot \overline{Q}\right)+b \left(\overline{\text{P2}}\cdot \overline{Q}\right)
\end{dmath*}

\begin{verbatim}
(*a Pair[Momentum[P1], Momentum[Q]] + b Pair[Momentum[P2], Momentum[Q]]*)
\end{verbatim}
\end{document}
