% !TeX program = pdflatex
% !TeX root = FCLoopFindTopologies.tex

\documentclass[../FeynCalcManual.tex]{subfiles}
\begin{document}
\hypertarget{fcloopfindtopologies}{
\section{FCLoopFindTopologies}\label{fcloopfindtopologies}\index{FCLoopFindTopologies}}

\texttt{FCLoopFindTopologies[\allowbreak{}exp,\ \allowbreak{}\{\allowbreak{}q1,\ \allowbreak{}q2,\ \allowbreak{}...\}]}
attempts to identify the loop integral topologies present in
\texttt{exp} by looking at the propagator denominators that depend on
the loop momenta \texttt{q1,\ \allowbreak{}q2,\ \allowbreak{}...} . It
returns a list of two entries, where the first one is the original
expression with the denominators rewritten as \texttt{GLI}s, and the
second one is the set of the identified topologies. Each of the
identified topologies must contain linearly independent propagators
(unless the option \texttt{FCLoopBasisOverdeterminedQ} is set to True),
but may lack propagators needed to form a complete basis.

\subsection{See also}

\hyperlink{toc}{Overview}, \hyperlink{fctopology}{FCTopology},
\hyperlink{gli}{GLI}.

\subsection{Examples}

Find topologies occurring in the 2-loop ghost self-energy amplitude

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{amp }\ExtensionTok{=} \FunctionTok{Get}\OperatorTok{[}\FunctionTok{FileNameJoin}\OperatorTok{[\{}\NormalTok{$FeynCalcDirectory}\OperatorTok{,} \StringTok{"Documentation"}\OperatorTok{,} \StringTok{"Examples"}\OperatorTok{,} 
      \StringTok{"Amplitudes"}\OperatorTok{,} \StringTok{"Gh{-}Gh{-}2L.m"}\OperatorTok{\}]]}\NormalTok{;}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res }\ExtensionTok{=}\NormalTok{ FCLoopFindTopologies}\OperatorTok{[}\NormalTok{amp}\OperatorTok{,} \OperatorTok{\{}\NormalTok{q1}\OperatorTok{,}\NormalTok{ q2}\OperatorTok{\}]}\NormalTok{;}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\text{Number of the initial candidate topologies: }3
\end{dmath*}

\begin{dmath*}\breakingcomma
\text{Number of the identified unique topologies: }3
\end{dmath*}

\begin{dmath*}\breakingcomma
\text{Number of the preferred topologies among the unique topologies: }0
\end{dmath*}

\begin{dmath*}\breakingcomma
\text{Number of the identified subtopologies: }0
\end{dmath*}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res }\SpecialCharTok{//} \FunctionTok{Last}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\left\{\text{FCTopology}\left(\text{fctopology1},\left\{\frac{1}{(\text{q2}^2+i \eta )},\frac{1}{(\text{q1}^2+i \eta )},\frac{1}{((\text{q1}+\text{q2})^2+i \eta )},\frac{1}{((p+\text{q1})^2+i \eta )},\frac{1}{((p-\text{q2})^2+i \eta )}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right),\text{FCTopology}\left(\text{fctopology2},\left\{\frac{1}{(\text{q2}^2+i \eta )},\frac{1}{(\text{q1}^2+i \eta )},\frac{1}{((p+\text{q2})^2+i \eta )},\frac{1}{((p-\text{q1})^2+i \eta )}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right),\text{FCTopology}\left(\text{fctopology3},\left\{\frac{1}{(\text{q2}^2+i \eta )},\frac{1}{(\text{q1}^2+i \eta )},\frac{1}{((p-\text{q1})^2+i \eta )},\frac{1}{((p-\text{q1}+\text{q2})^2+i \eta )}\right\},\{\text{q1},\text{q2}\},\{p\},\{\},\{\}\right)\right\}
\end{dmath*}

Find topologies occurring in the 2-loop QCD corrections to the
\(B_s\)-meson mixing

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{topos }\ExtensionTok{=} \FunctionTok{Get}\OperatorTok{[}\FunctionTok{FileNameJoin}\OperatorTok{[\{}\NormalTok{$FeynCalcDirectory}\OperatorTok{,} \StringTok{"Documentation"}\OperatorTok{,} \StringTok{"Examples"}\OperatorTok{,} 
      \StringTok{"Topologies"}\OperatorTok{,} \StringTok{"BMixingTopos2L.m"}\OperatorTok{\}]]}\NormalTok{;}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{topos }\SpecialCharTok{//} \FunctionTok{Length}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
544
\end{dmath*}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res }\ExtensionTok{=}\NormalTok{ FCLoopFindTopologies}\OperatorTok{[}\NormalTok{topos}\OperatorTok{,} \OperatorTok{\{}\NormalTok{k1}\OperatorTok{,}\NormalTok{ k2}\OperatorTok{\}]}\NormalTok{;}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\text{Number of the initial candidate topologies: }18
\end{dmath*}

\begin{dmath*}\breakingcomma
\text{Number of the identified unique topologies: }18
\end{dmath*}

\begin{dmath*}\breakingcomma
\text{Number of the preferred topologies among the unique topologies: }0
\end{dmath*}

\begin{dmath*}\breakingcomma
\text{Number of the identified subtopologies: }0
\end{dmath*}

Show the first two topologies

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(res }\SpecialCharTok{//} \FunctionTok{Last}\NormalTok{)}\OperatorTok{[[}\DecValTok{1}\NormalTok{ ;; }\DecValTok{2}\OperatorTok{]]}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\left\{\text{FCTopology}\left(\text{fctopology1},\left\{\frac{1}{((\text{k2}+\text{p1})^2+i \eta )},\frac{1}{(\text{k2}^2-\text{mb}^2+i \eta )},\frac{1}{(\text{k1}^2-\text{mc}^2+i \eta )},\frac{1}{((\text{k1}+\text{k2})^2-\text{mc}^2+i \eta )},\frac{1}{((\text{k1}-\text{p1})^2-\text{mc}^2+i \eta )}\right\},\{\text{k1},\text{k2}\},\{\text{p1}\},\{\},\{\}\right),\text{FCTopology}\left(\text{fctopology2},\left\{\frac{1}{((\text{k2}-\text{p1})^2+i \eta )},\frac{1}{(\text{k2}^2-\text{mb}^2+i \eta )},\frac{1}{(\text{k1}^2-\text{mc}^2+i \eta )},\frac{1}{((\text{k1}+\text{p1})^2-\text{mc}^2+i \eta )},\frac{1}{((\text{k1}+\text{k2})^2-\text{mc}^2+i \eta )}\right\},\{\text{k1},\text{k2}\},\{\text{p1}\},\{\},\{\}\right)\right\}
\end{dmath*}

In practical calculations even the simple extraction of topologies from
the given list of diagrams can take considerable amount of time. This is
why it is better to parallelize this process as much as possible.

We can split this part into two steps, were we first apply
\texttt{FCLoopIsolate} to the resulting amplitudes and then pass the
output to \texttt{FCLoopFindTopologies}. To avoid the unnecessary
application of \texttt{FCLoopIsolate} during this step, we should
specify the head with which the topologies have been wrapped via the
option \texttt{FCLoopIsolate}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{isolatedTopos }\ExtensionTok{=}\NormalTok{ FCLoopIsolate}\OperatorTok{[}\NormalTok{topos}\OperatorTok{[[}\DecValTok{44}\NormalTok{ ;; }\DecValTok{48}\OperatorTok{]],} \OperatorTok{\{}\NormalTok{k1}\OperatorTok{,}\NormalTok{ k2}\OperatorTok{\},}\NormalTok{  Collecting }\OtherTok{{-}\textgreater{}} \ConstantTok{False}\OperatorTok{,}\NormalTok{ Factoring }\OtherTok{{-}\textgreater{}} \ConstantTok{False}\OperatorTok{,} \FunctionTok{Numerator} \OtherTok{{-}\textgreater{}} \ConstantTok{False}\OperatorTok{,} \FunctionTok{Head} \OtherTok{{-}\textgreater{}}\NormalTok{ loopDen}\OperatorTok{]}\NormalTok{;}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{res }\ExtensionTok{=}\NormalTok{ FCLoopFindTopologies}\OperatorTok{[}\NormalTok{isolatedTopos}\OperatorTok{,} \OperatorTok{\{}\NormalTok{k1}\OperatorTok{,}\NormalTok{ k2}\OperatorTok{\},}\NormalTok{ FCLoopIsolate }\OtherTok{{-}\textgreater{}}\NormalTok{ loopDen}\OperatorTok{,} \FunctionTok{Head} \OtherTok{{-}\textgreater{}}\NormalTok{ ampDen}\OperatorTok{,}\NormalTok{ Collecting }\OtherTok{{-}\textgreater{}} \ConstantTok{False}\OperatorTok{]}\NormalTok{; }
  
 
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\text{Number of the initial candidate topologies: }2
\end{dmath*}

\begin{dmath*}\breakingcomma
\text{Number of the identified unique topologies: }2
\end{dmath*}

\begin{dmath*}\breakingcomma
\text{Number of the preferred topologies among the unique topologies: }0
\end{dmath*}

\begin{dmath*}\breakingcomma
\text{Number of the identified subtopologies: }0
\end{dmath*}
\end{document}
