% !TeX program = pdflatex
% !TeX root = FCLoopReplaceQuadraticEikonalPropagators.tex

\documentclass[../FeynCalcManual.tex]{subfiles}
\begin{document}
\hypertarget{fcloopreplacequadraticeikonalpropagators}{
\section{FCLoopReplaceQuadraticEikonalPropagators}\label{fcloopreplacequadraticeikonalpropagators}\index{FCLoopReplaceQuadraticEikonalPropagators}}

\texttt{FCLoopReplaceQuadraticEikonalPropagators[\allowbreak{}topologies]}
identifies \texttt{SFAD}s and \texttt{CFAD}s in \texttt{topologies} that
represent mixed quadratic-eikonal propagators,
e.g.~\([p^2 - 2 p \cdot q]\). Using the information on loop momenta
provided by the user the routine will try to rewrite those denominators
by completing the square, e.g.~as in \([(p-q)^2 - q^2]\).

This procedure is useful because one cannot easily determine the
momentum flow from looking at quadratic-eikonal propagators as it is
possible in the case of purely quadratic ones.

For this to work it is crucial to specify the loop momenta via the
\texttt{LoopMomenta} option as well as the kinematics
(\texttt{IntermediateSubstitutions}) and the rules for completing the
square (\texttt{InitialSubstitutions}) on the purely loop-momentum
dependent piece of the propagator
(e.g.~\(p_1^2 - 2 p_1 \cdot p_2 + p_2^2\) goes to \((p_1+p_2)^2\).

Internally this routine uses \texttt{ToGFAD} and \texttt{FromGFAD}.

\subsection{See also}

\hyperlink{toc}{Overview}, \hyperlink{fctopology}{FCTopology},
\hyperlink{gfad}{GFAD}, \hyperlink{fromgfad}{FromGFAD},
\hyperlink{togfad}{ToGFAD}.

\subsection{Examples}

\begin{dmath*}\breakingcomma
(\text{DataType}[\#,\text{FCVariable}]=\text{True})\&\text{/@}\{\text{gkin},\text{meta},\text{u0b}\};
\end{dmath*}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{topos }\ExtensionTok{=} \OperatorTok{\{}\NormalTok{FCTopology}\OperatorTok{[}\NormalTok{preTopoDia1}\OperatorTok{,} \OperatorTok{\{}\NormalTok{SFAD}\OperatorTok{[\{\{}\NormalTok{k2}\OperatorTok{,} \DecValTok{0}\OperatorTok{\},} \OperatorTok{\{}\DecValTok{0}\OperatorTok{,} \DecValTok{1}\OperatorTok{\},} \DecValTok{1}\OperatorTok{\}],}\NormalTok{ SFAD}\OperatorTok{[\{\{}\NormalTok{k1}\OperatorTok{,} \DecValTok{0}\OperatorTok{\},} \OperatorTok{\{}\DecValTok{0}\OperatorTok{,} \DecValTok{1}\OperatorTok{\},} \DecValTok{1}\OperatorTok{\}],} 
\NormalTok{     SFAD}\OperatorTok{[\{\{}\NormalTok{k1 }\SpecialCharTok{+}\NormalTok{ k2}\OperatorTok{,} \DecValTok{0}\OperatorTok{\},} \OperatorTok{\{}\DecValTok{0}\OperatorTok{,} \DecValTok{1}\OperatorTok{\},} \DecValTok{1}\OperatorTok{\}],}\NormalTok{ SFAD}\OperatorTok{[\{\{}\DecValTok{0}\OperatorTok{,} \SpecialCharTok{{-}}\NormalTok{k1 . nb}\OperatorTok{\},} \OperatorTok{\{}\DecValTok{0}\OperatorTok{,} \DecValTok{1}\OperatorTok{\},} \DecValTok{1}\OperatorTok{\}],}\NormalTok{ SFAD}\OperatorTok{[\{\{}\NormalTok{k2}\OperatorTok{,} \SpecialCharTok{{-}}\NormalTok{(meta}\SpecialCharTok{*}\NormalTok{u0b}\SpecialCharTok{*}\NormalTok{k2 . nb)}\OperatorTok{\},} \OperatorTok{\{}\DecValTok{0}\OperatorTok{,} \DecValTok{1}\OperatorTok{\},} \DecValTok{1}\OperatorTok{\}],} 
\NormalTok{     SFAD}\OperatorTok{[\{\{}\NormalTok{k1 }\SpecialCharTok{+}\NormalTok{ k2}\OperatorTok{,} \SpecialCharTok{{-}}\DecValTok{2}\SpecialCharTok{*}\NormalTok{gkin}\SpecialCharTok{*}\NormalTok{meta}\SpecialCharTok{*}\NormalTok{u0b}\SpecialCharTok{*}\NormalTok{(k1 }\SpecialCharTok{+}\NormalTok{ k2) . }\FunctionTok{n}\OperatorTok{\},} \OperatorTok{\{}\DecValTok{0}\OperatorTok{,} \DecValTok{1}\OperatorTok{\},} \DecValTok{1}\OperatorTok{\}],}\NormalTok{ SFAD}\OperatorTok{[\{\{}\NormalTok{k1}\OperatorTok{,} \SpecialCharTok{{-}}\DecValTok{2}\SpecialCharTok{*}\NormalTok{gkin}\SpecialCharTok{*}\NormalTok{meta}\SpecialCharTok{*}\NormalTok{k1 . }\FunctionTok{n} \SpecialCharTok{+}\NormalTok{ meta}\SpecialCharTok{*}\NormalTok{u0b}\SpecialCharTok{*}\NormalTok{k1 . nb}\OperatorTok{\},} 
       \OperatorTok{\{}\DecValTok{2}\SpecialCharTok{*}\NormalTok{gkin}\SpecialCharTok{*}\NormalTok{meta}\SpecialCharTok{\^{}}\DecValTok{2}\SpecialCharTok{*}\NormalTok{u0b}\OperatorTok{,} \DecValTok{1}\OperatorTok{\},} \DecValTok{1}\OperatorTok{\}],}\NormalTok{ SFAD}\OperatorTok{[\{\{}\NormalTok{k1}\OperatorTok{,} \SpecialCharTok{{-}}\DecValTok{2}\SpecialCharTok{*}\NormalTok{gkin}\SpecialCharTok{*}\NormalTok{meta}\SpecialCharTok{*}\NormalTok{u0b}\SpecialCharTok{*}\NormalTok{k1 . }\FunctionTok{n} \SpecialCharTok{+}\NormalTok{ meta}\SpecialCharTok{*}\NormalTok{u0b}\SpecialCharTok{*}\NormalTok{k1 . nb}\OperatorTok{\},} \OperatorTok{\{}\DecValTok{2}\SpecialCharTok{*}\NormalTok{gkin}\SpecialCharTok{*}\NormalTok{meta}\SpecialCharTok{\^{}}\DecValTok{2}\SpecialCharTok{*}\NormalTok{u0b}\SpecialCharTok{\^{}}\DecValTok{2}\OperatorTok{,} \DecValTok{1}\OperatorTok{\},} \DecValTok{1}\OperatorTok{\}]\},} 
    \OperatorTok{\{}\NormalTok{k1}\OperatorTok{,}\NormalTok{ k2}\OperatorTok{\},} \OperatorTok{\{}\FunctionTok{n}\OperatorTok{,}\NormalTok{ nb}\OperatorTok{\},} \OperatorTok{\{}\FunctionTok{Hold}\OperatorTok{[}\NormalTok{SPD}\OperatorTok{][}\FunctionTok{n}\OperatorTok{]} \OtherTok{{-}\textgreater{}} \DecValTok{0}\OperatorTok{,} \FunctionTok{Hold}\OperatorTok{[}\NormalTok{SPD}\OperatorTok{][}\NormalTok{nb}\OperatorTok{]} \OtherTok{{-}\textgreater{}} \DecValTok{0}\OperatorTok{,} \FunctionTok{Hold}\OperatorTok{[}\NormalTok{SPD}\OperatorTok{][}\FunctionTok{n}\OperatorTok{,}\NormalTok{ nb}\OperatorTok{]} \OtherTok{{-}\textgreater{}} \DecValTok{2}\OperatorTok{\},} \OperatorTok{\{\}]\}}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\left\{\text{FCTopology}\left(\text{preTopoDia1},\left\{\frac{1}{(\text{k2}^2+i \eta )},\frac{1}{(\text{k1}^2+i \eta )},\frac{1}{((\text{k1}+\text{k2})^2+i \eta )},\frac{1}{(-\text{k1}\cdot \;\text{nb}+i \eta )},\frac{1}{(\text{k2}^2-\text{meta} \;\text{u0b} (\text{k2}\cdot \;\text{nb})+i \eta )},\frac{1}{((\text{k1}+\text{k2})^2-2 \;\text{gkin} \;\text{meta} \;\text{u0b} ((\text{k1}+\text{k2})\cdot n)+i \eta )},\frac{1}{(\text{k1}^2+\text{meta} \;\text{u0b} (\text{k1}\cdot \;\text{nb})-2 \;\text{gkin} \;\text{meta} (\text{k1}\cdot n)-2 \;\text{gkin} \;\text{meta}^2 \;\text{u0b}+i \eta )},\frac{1}{(\text{k1}^2+\text{meta} \;\text{u0b} (\text{k1}\cdot \;\text{nb})-2 \;\text{gkin} \;\text{meta} \;\text{u0b} (\text{k1}\cdot n)-2 \;\text{gkin} \;\text{meta}^2 \;\text{u0b}^2+i \eta )}\right\},\{\text{k1},\text{k2}\},\{n,\text{nb}\},\{\text{Hold}[\text{SPD}][n]\to 0,\text{Hold}[\text{SPD}][\text{nb}]\to 0,\text{Hold}[\text{SPD}][n,\text{nb}]\to 2\},\{\}\right)\right\}
\end{dmath*}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{FCLoopReplaceQuadraticEikonalPropagators}\OperatorTok{[}\NormalTok{topos}\OperatorTok{,}\NormalTok{ LoopMomenta }\OtherTok{{-}\textgreater{}} \OperatorTok{\{}\NormalTok{k1}\OperatorTok{,}\NormalTok{ k2}\OperatorTok{\},} 
\NormalTok{  InitialSubstitutions }\OtherTok{{-}\textgreater{}} \OperatorTok{\{}
\NormalTok{    ExpandScalarProduct}\OperatorTok{[}\NormalTok{SPD}\OperatorTok{[}\NormalTok{k1 }\SpecialCharTok{{-}}\NormalTok{ k2}\OperatorTok{]]} \OtherTok{{-}\textgreater{}}\NormalTok{ SPD}\OperatorTok{[}\NormalTok{k1 }\SpecialCharTok{{-}}\NormalTok{ k2}\OperatorTok{],} 
\NormalTok{    ExpandScalarProduct}\OperatorTok{[}\NormalTok{SPD}\OperatorTok{[}\NormalTok{k1 }\SpecialCharTok{+}\NormalTok{ k2}\OperatorTok{]]} \OtherTok{{-}\textgreater{}}\NormalTok{ SPD}\OperatorTok{[}\NormalTok{k1 }\SpecialCharTok{+}\NormalTok{ k2}\OperatorTok{]\},} 
\NormalTok{  IntermediateSubstitutions }\OtherTok{{-}\textgreater{}} \OperatorTok{\{}\NormalTok{SPD}\OperatorTok{[}\FunctionTok{n}\OperatorTok{]} \OtherTok{{-}\textgreater{}} \DecValTok{0}\OperatorTok{,}\NormalTok{ SPD}\OperatorTok{[}\NormalTok{nb}\OperatorTok{]} \OtherTok{{-}\textgreater{}} \DecValTok{0}\OperatorTok{,}\NormalTok{ SPD}\OperatorTok{[}\FunctionTok{n}\OperatorTok{,}\NormalTok{ nb}\OperatorTok{]} \OtherTok{{-}\textgreater{}} \DecValTok{0}\OperatorTok{\}]}
\end{Highlighting}
\end{Shaded}

\begin{dmath*}\breakingcomma
\left\{\text{FCTopology}\left(\text{preTopoDia1},\left\{\frac{1}{(\text{k2}^2+i \eta )},\frac{1}{(\text{k1}^2+i \eta )},\frac{1}{((\text{k1}+\text{k2})^2+i \eta )},\frac{1}{(-\text{k1}\cdot \;\text{nb}+i \eta )},\frac{1}{((\text{k2}-\frac{\text{meta} \;\text{u0b} \;\text{nb}}{2})^2+i \eta )},\frac{1}{((\text{k1}+\text{k2}-\text{gkin} \;\text{meta} \;\text{u0b} n)^2+i \eta )},\frac{1}{((\text{k1}-\text{gkin} \;\text{meta} n+\frac{\text{meta} \;\text{u0b} \;\text{nb}}{2})^2-2 \;\text{gkin} \;\text{meta}^2 \;\text{u0b}+i \eta )},\frac{1}{((\text{k1}-\text{gkin} \;\text{meta} \;\text{u0b} n+\frac{\text{meta} \;\text{u0b} \;\text{nb}}{2})^2-2 \;\text{gkin} \;\text{meta}^2 \;\text{u0b}^2+i \eta )}\right\},\{\text{k1},\text{k2}\},\{n,\text{nb}\},\{\text{Hold}[\text{SPD}][n]\to 0,\text{Hold}[\text{SPD}][\text{nb}]\to 0,\text{Hold}[\text{SPD}][n,\text{nb}]\to 2\},\{\}\right)\right\}
\end{dmath*}
\end{document}
